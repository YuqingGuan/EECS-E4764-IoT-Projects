

In Lab 3, we used SPI 4-wires mode to communicate with accelerator. First, in the hardware part, we used the default pins for SPI on the Huzzah board. For a 4-wire mode, we connect SDA, SDO and SCL (the pins on the accelerator) to MO, MI and SCK (the pins on the Huzzah board). To control the accelerator, we connect the CS pin with pin15 on the Huzzah board. Every time  we want to write or read data from the accelerator, we should enable it (set value 0) first and disable it (set value 1) after transmission.

The code for controlling the accelerator is basically writing an 8-bits data to it. First of all, we should write (00001000) to the register 0x2D in order to activate it to measure status. Then we write (00001111) to register 0x31 to get a proper data format for the data of X and Y axis. 

After we activate the accelerator, we want to read the data of X and Y axis, which are stored in the registers whose address are 0x32 to 0x35. In the SPI protocol, we should write an 8-bit data to the accelerator to read the data. The principal for the written data is: The first bit is set to choose whether write or read, and the second bit is set to choose whether read only one register or multiple registers. The following six bit are the address of the target register. For example, if we want to read the data from 0x32 (110010), we should first write 0xf2 (11110010) to the accelerator. In the micropython library, the function read has a parameter called write which allows the user to write and read in one step. Besides we set the first parameter of this function to 4 so that we can read 4 registersâ€™ data at one time.